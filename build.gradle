plugins {
    id 'java'
}

group 'sonnicon'

sourceCompatibility = 1.8
sourceSets.main.java.srcDirs = ["src/"]
sourceSets.main.resources.srcDirs = ["assets/"]

repositories {
    mavenCentral()
    maven { url "https://jitpack.io" }
}

dependencies {
    implementation 'com.github.Anuken.Mindustry:core:v115'
}

task "buildDex" {
    dependsOn "build"
    doLast {

        File original = jar.archiveFile.get().asFile
        File renamed = new File(original.getParent(), "dexed-" + original.name)
        original.renameTo(renamed)

        exec {
            workingDir renamed.parent 
            if (System.getProperty('os.name').toLowerCase(Locale.ROOT).contains('windows')) {
                commandLine 'cmd', '/c', "dx --dex --output=\"" + renamed.name + "\" \"" + renamed.name + "\""
            } else {
                commandLine "dx", "--dex", "--output=" + renamed.name, renamed.name
            }
        }
    }
}


